<!doctype html>

<html lang="en">

<head>

  <meta charset="utf-8">

  <meta http-equiv="x-ua-compatible" content="ie=edge">

  <title>Panel Example</title>

  <meta name="description" content="">

  <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">

 

  <style>

    html {

      background-size: cover;

      box-sizing: border-box;

    }

 

    *,

    *:before,

    *:after {

        box-sizing: inherit;

    }

 

    body {

      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";

    }

 

    .visually-hidden {

      clip: rect(1px, 1px, 1px, 1px);

      height: .5px;

      overflow: hidden;

      position: absolute;

      white-space: nowrap;

      width: .5px;

    }

 

    #wrapper[aria-hidden="true"] {

      pointer-events: none;

    }

 

    .Dialog-wrapper {

      align-items: center;

      background: rgba(0,0,0,.6);

      bottom: 0;

      display: flex;

      left: 0;

      justify-content: center;

      position: absolute;

      right: 0;

      top: 0;

    }

 

    .Dialog-wrapper[hidden] {

      display: none;

    }

 

    .Dialog {

      background-color: #fff;

      border: 2px solid #000;

 

      max-height: 100vh;

 

      width: 50%;

      z-index: 1;

    }

 

    .Dialog-header {

      align-items: center;

      border-bottom: 1px solid #000;

      display: flex;

      padding: 1rem;

      position: relative;

    }

 

    .Dialog-title {

      flex: 1;

      margin: 0;

    }

 

    .Dialog-close {

      background: 0;

      font-size: 2rem;

      font-weight: bold;

      border: 0;

      padding: 0;

      position: absolute;

      right: 1rem;

    }

 

    .Dialog-dock {

      align-items: center;

      box-shadow: 0 2px 2px 0 rgba(0,0,0,0.15);

      display: flex;

      justify-content: space-between;

      padding: 1rem;

    }

 

    .Dialog-navigator-control {

      background: none;

      border: 1px solid ;

      font-size: 1.5rem;

    }

 

    .Dialog-navigator-control span {

      pointer-events: none;

    }

 

    #Dialog-navigator-control-previous {

      transform: rotate(180deg);

    }

 

    .Dialog-body {

      padding: 1rem;

    }

 

    .Dialog-footer {

      padding: 1rem;

    } */

 

  </style>

</head>

 

<body>

  <div id="wrapper">

    <main>

      <h1>Panel Example v2</h1>

      <p>The following are barebone examples of Panel</p>

      <span class="visually-hidden">start of panel example</span>

      <button id="basic" class="launch" type="button">Launch Basic Panel</button>

      <button id="full" class="launch" type="button">Launch Full Panel</button>

      <span class="visually-hidden">end of panel example</span>

    </main>

  </div>

 

  <!-- Dialog container should not be part of any of the page content. It should be direct child of the body, but as a sibling of the main page wrapper. -->

 

  <div id="basic-dialog" class="Dialog-wrapper" hidden aria-hidden="true">

    <div class="Dialog" role="dialog" aria-labelledby="basic-dialog-title" aria-describedby="basic-dialog-body" tabindex="-1" >

      <div class="Dialog-header">

        <button class="Dialog-close" type="button" aria-label="close dialog">

          &xotime;

        </button>

        <h1 id="basic-dialog-title" class="Dialog-title">Basic Dialog Example</h1>

      </div>

      <div id="basic-dialog-body" class="Dialog-body">

        <p>The following is a barebones example of Panel as a dialog with only 1 interactive element, the Close button.</p>

        <p>A dialog exhibits the following:</p>

 

        <table>

          <thead>

            <tr>

              <th scope="col">Item</th>

              <th scope="col">Notes</th>

            </tr>

          </thead>

          <tbody>

            <tr>

              <td>ARIA</td>

              <td>

                <ul>

                  <li><code>role="dialog"</code></li>

                  <li><code>aria-labelledby</code> referencing the <code>H1</code> dialog title</li>

                  <li><code>aria-describedby</code> referencing the dialog body</li>

                  <li><code>aria-hidden</code> should be maintained on the main page wrapper (with the dialog as direct child of body, and sibling of page wrapper)</li>

                </ul>

              </td>

            </tr>

            <tr>

              <td>Focus</td>

              <td>

                <ul>

                  <li>When opened, focus should be set to the first focusable element in the dialog. In this case, it is the close button.</li>

                  <li>When the dialog is closed, focus should return back to the button/ trigger that produced the dialog.</li>

                  <li>Clicking/ tapping/ blurring outside the dialog will return focus back to the close button.</li>

                </ul>

              </td>

            </tr>

 

            <tr>

              <td>Keyboard</td>

              <td>

                <ul>

                  <li><kbd>ESC</kbd> should close the dialog when it is open.</li>

                  <li>Since there is only one focusable item, the close button, focus should cycle between the close button and the Panel body so that there is no perceived TAB trap.</li>

                </ul>

              </td>

            </tr>

          </tbody>

        </table>

      </div>

    </div>

  </div>

  <div id="basic-dialog" class="Dialog" role="dialog" aria-labelledby="basic-dialog-title" aria-describedby="basic-dialog-body" tabindex="-1" hidden aria-hidden="true">

    <div class="Dialog-header">

      <button class="Dialog-close" type="button" aria-label="close dialog">

        &xotime;

      </button>

      <h1 id="basic-dialog-title" class="Dialog-title">Basic Dialog Example</h1>

    </div>

    <div id="basic-dialog-body" class="Dialog-body">

      <p>The following is a barebones example of Panel as a dialog with only 1 interactive element, the Close button.</p>

      <p>A dialog exhibits the following:</p>

 

      <table>

        <thead>

          <tr>

            <th scope="col">Item</th>

            <th scope="col">Notes</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td>ARIA</td>

            <td>

              <ul>

                <li><code>role="dialog"</code></li>

                <li><code>aria-labelledby</code> referencing the <code>H1</code> dialog title</li>

                <li><code>aria-describedby</code> referencing the dialog body</li>

                <li><code>aria-hidden</code> should be maintained on the main page wrapper (with the dialog as direct child of body, and sibling of page wrapper)</li>

              </ul>

            </td>

          </tr>

          <tr>

            <td>Focus</td>

            <td>

              <ul>

                <li>When opened, focus should be set to the first focusable element in the dialog. In this case, it is the close button.</li>

                <li>When the dialog is closed, focus should return back to the button/ trigger that produced the dialog.</li>

                <li>Clicking/ tapping/ blurring outside the dialog will return focus back to the close button.</li>

              </ul>

            </td>

          </tr>

 

          <tr>

            <td>Keyboard</td>

            <td>

              <ul>

                <li><kbd>ESC</kbd> should close the dialog when it is open.</li>

                <li>Since there is only one focusable item, the close button, focus should cycle between the close button and the Panel body so that there is no perceived TAB trap.</li>

              </ul>

            </td>

          </tr>

        </tbody>

      </table>

    </div>

  </div>

 

  <div id="full-dialog" class="Dialog-wrapper" hidden aria-hidden="true">

    <div class="Dialog" role="dialog"  aria-labelledby="full-dialog-title" tabindex="-1">

    <div class="Dialog-header">

      <button class="Dialog-close" type="button" aria-label="close dialog">

        &xotime;

      </button>

      <h1 id="full-dialog-title" class="Dialog-title">Full Dialog Example (with Dock)</h1>

    </div>

 

    <section class="Dialog-dock" aria-label="panel options">

      dock area

      <div class="Dialog-navigator" role="group" aria-label="item navigation">

        <span id="Dialog-navigator-status" aria-live="assertive">1 of 5 items</span>

        <button id="Dialog-navigator-control-previous" class="Dialog-navigator-control" type="button" aria-label="Previous, item 5">

          <span aria-hidden="true">&rarr;</span>

        </button>

        <button id="Dialog-navigator-control-next" class="Dialog-navigator-control" type="button" aria-label="Next, item 2">

          <span aria-hidden="true">&rarr;</span>

        </button>

      </div>

    </section>

    <div id="full-dialog-body" class="Dialog-body">

      <div>

        <p>The following is a barebones example of Panel as a dialog, with multiple interactive elements</p>

 

        <form>

          <fieldset>

              <legend>Work Phone</legend>

              <div>

                <label for="number">

                  Number

                  <input id="number" />

                </label>

              </div>

              <div>

                <label for="ext">

                  Ext (optional)

                  <input id="ext" />

                </label>

              </div>

          </fieldset>

        </form>

      </div>

    </div>

 

    <div class="Dialog-footer">

      <button type="button">Cancel</button>

    </div>

  </div>

  </div>

 

 

  <script>

    var wrapper = document.getElementById('wrapper'),

      winTitle = document.title,

      currentItem = 1,

      dialog,

      close,

      trigger;

 

    var closeDialog = function closeDialog() {

 

      document.removeEventListener('keydown', onKeydown);

      document.removeEventListener('click', onClick);

      document.removeEventListener('focus', onFocus, true);

 

      document.title = winTitle; // restore dialog title

 

      wrapper.setAttribute('aria-hidden', 'false'); // show main contents

      trigger.focus(); // focus trigger

      dialog.setAttribute('aria-hidden', 'true');

      dialog.setAttribute('hidden', '');

 

    };

 

    var showDialog = function showDialog() {

 

      close = dialog.querySelector('.Dialog-close');

 

      dialog.removeAttribute('hidden');

      dialog.setAttribute('aria-hidden', 'false');

      close.focus(); // focus first focusable element

 

      wrapper.setAttribute('aria-hidden', 'true'); // hide main contents

      document.title = dialog.querySelector('.Dialog-title').innerText; // set document title to dialog title

 

      setTimeout(function () {

        document.addEventListener('keydown', onKeydown);

        document.addEventListener('click', onClick);

        document.addEventListener('focus', onFocus, true);

      }, 5);

    };

 

   var onClick = function onClick(event) {

      var target = event.target;

 

      if (target === close) {

        closeDialog();

      } else if (target.classList.contains('Dialog-navigator-control')) {

        if (target.id === 'Dialog-navigator-control-previous') {

          updateUI(-1);

        } else {

          updateUI(1);

        }

      } else if (!dialog.contains(target) || target === dialog) {

        // click outside panel happened, return focus to close button

        close.focus();

      }

    }

 

    var onFocus = function onFocus(event) {

      // focus happened outside of the dialog, return focus to close button

      if (!dialog.contains(event.target)) {

        event.preventDefault();

        close.focus();

      }

    }

 

    var onKeydown = function onKeydown(event) {

      var target = event.target;

      var key = event.key;

 

      if (key.match('Esc')) {

        event.preventDefault();

        closeDialog();

      } else if (dialog.contains(target)) {

 

        var focusable = dialog.querySelectorAll('a[href], area[href], input:not([disabled]), ' +

          'select:not([disabled]),textarea:not([disabled]), button:not([disabled]), ' +

          'iframe, object, embed, *[tabindex], *[contenteditable]');

 

        if (key === 'Tab') {

          if (focusable.length > 1) {

            if (target === focusable[focusable.length - 1] && !event.shiftKey) {

              event.preventDefault();

              focusable[0].focus();

            } else if (target == focusable[0] && event.shiftKey) {

              event.preventDefault();

              focusable[focusable.length - 1].focus();

            }

          } else if (focusable.length === 1) {

            if (target === dialog) {

              event.preventDefault();

              close.focus();

            } else if (target === close) {

              event.preventDefault();

              dialog.focus();

            }

          }

        }

      }

    };

 

    var updateUI = function updateUI(dir) {

      var

        status = document.getElementById('Dialog-navigator-status'),

        nextControl = document.getElementById('Dialog-navigator-control-next'),

        prevControl = document.getElementById('Dialog-navigator-control-previous'),

        nextItem = (currentItem + 5 + dir) % 5,

        next,

        prev;

 

      nextItem = (nextItem === 0) ? 5 : nextItem;

      if (dir === -1) {

        prev = (nextItem === 1) ? 5 : nextItem - 1;

        next = currentItem;

      } else {

        next = (nextItem === 5) ? 1 : nextItem + 1;

        prev = currentItem;

      }

 

      status.innerText = ' ';

      status.innerText = '' + nextItem + ' of 5 items';

      prevControl.setAttribute('aria-label', 'Previous, item ' + prev);

      nextControl.setAttribute('aria-label', 'Next, item ' + next);

 

      currentItem = nextItem;

 

    };

 

    Array.prototype.slice.call(document.querySelectorAll('.launch')).forEach(function (button) {

      button.addEventListener('click', function (event) {

 

        trigger = event.target;

        dialog = document.getElementById(trigger.id + '-dialog');

 

        if (dialog.hasAttribute('hidden')) { // if dialog is closed

          showDialog();

        } else {

          closeDialog();

        }

      });

 

    });

 

  </script>

</body>
</html>